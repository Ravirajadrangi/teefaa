<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Make a system snapshot &mdash; Cloudmesh Teefaa 0.4.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.0.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Cloudmesh Teefaa 0.4.0 documentation" href="index.html" />
    <link rel="next" title="Support" href="support.html" />
    <link rel="prev" title="Installation" href="install.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Cloudmesh Teefaa</a>
        <span class="navbar-text navbar-version pull-left"><b>0.4.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#id1">Installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Make a system snapshot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#write-teefaafile-yml">Write Teefaafile.yml</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes-about-the-system-size">Notes about the system size</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="support.html#bugs-and-issues">Bugs and issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="support.html#contact-for-futuregrid-users">Contact for FutureGrid users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#contributors">Contributors</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Make a system snapshot</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#write-teefaafile-yml">Write Teefaafile.yml</a></li>
<li><a class="reference internal" href="#notes-about-the-system-size">Notes about the system size</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="install.html" title="Previous Chapter: Installation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Installation</span>
    </a>
  </li>
  <li>
    <a href="support.html" title="Next Chapter: Support"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Support &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/make_snapshot.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="make-a-system-snapshot">
<h1>Make a system snapshot<a class="headerlink" href="#make-a-system-snapshot" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">You need to be able to ssh login to the system.</p>
</li>
<li><p class="first">You need to be able to use sudo.</p>
</li>
<li><p class="first">The partition for /tmp on the system has to have enough
space to have clone of system and the compressed image file.
Roughly estimate, compressed image will be 30~40% of original,
so /tmp should be able to have 130~140% of system size. You can
check it df command.:</p>
<div class="highlight-python"><pre>df -h

Filesystem      Size  Used Avail Use% Mounted on
/dev/sda2       9.2G  2.1G  6.7G  24% /
udev            237M  4.0K  237M   1% /dev
tmpfs            99M  220K   99M   1% /run
none            5.0M     0  5.0M   0% /run/lock
none            246M     0  246M   0% /run/shm</pre>
</div>
<p>In this example, you need to have 2.1*140/100 = 2.94G on the same
partition /dev/sda2.</p>
</li>
</ul>
</div>
<div class="section" id="write-teefaafile-yml">
<h2>Write Teefaafile.yml<a class="headerlink" href="#write-teefaafile-yml" title="Permalink to this headline">¶</a></h2>
<p>Create a directory for teefaa and write Teefaafile.yml.
This example is for a machine named host1 which is
running Ubuntu-12.04 LTS.:</p>
<div class="highlight-python"><pre>mkdir -p teefaa/host1
cd teefaa/host1
vi Teefaafile.yml</pre>
</div>
<div class="highlight-python"><pre># Teefaafile.yml

snapshot_config:
  hostname: host1
  snapshot_path: .teefaa/host1-2014-01-20.squashfs
  os:
    distro: ubuntu
    ver: 12.04

ssh_config: .teefaa/ssh_config</pre>
</div>
<p>And then, Write ssh_config:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mkdir</span> <span class="o">.</span><span class="n">teefaa</span>
<span class="n">vi</span> <span class="o">.</span><span class="n">teefaa</span><span class="o">/</span><span class="n">ssh_config</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Host host1
  Hostname &lt;ip address&gt;
  User &lt;username&gt;
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentityFile &lt;path to ssh private key&gt;
  IdentitiesOnly yes
  LogLevel FATAL</pre>
</div>
<p>Execute teefaa make-snapshot.</p>
<div class="highlight-python"><pre>teefaa make-snapshot</pre>
</div>
<p>It will take a while to finish this.</p>
</div>
<div class="section" id="notes-about-the-system-size">
<h2>Notes about the system size<a class="headerlink" href="#notes-about-the-system-size" title="Permalink to this headline">¶</a></h2>
<p>As you can see, Teefaa uses ssh and transfer the system image over the network.
If your system is big, it will take very long. We strongly recommend you
sepalately have your large data on a different partition and save/transfer
data in another way.</p>
<p>If you have large data and want to exclude the directories, you can exclude them by
adding exclude option on the Teefaafile.yml like this.</p>
<div class="highlight-python"><pre>snapshot_config:
  hostname: host1
  snapshot_path: .teefaa/host1-2014-01-20.squashfs
  os:
    distro: ubuntu
    ver: 12.04
  exclude:
    - /path/to/large/dir1
    - /path/to/large/dir2</pre>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2014 Indiana University, developed by K. Tanaka, G. von Laszewski, F. Wang, J. Diaz, A. Streib.<br/>
    </p>
  </div>
</footer>
  </body>
</html>