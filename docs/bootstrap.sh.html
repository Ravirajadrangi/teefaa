<!DOCTYPE html>
<html>
<head>
    <meta http-equiv='content-type' content='text/html;charset=utf-8'>
    <title>bootstrap.sh</title>
    <link rel=stylesheet href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id=container>
    <div id=background></div>
    <table cellspacing=0 cellpadding=0>
    <thead>
      <tr>
        <th class=docs><h1>bootstrap.sh</h1></th>
        <th class=code></th>
      </tr>
    </thead>
    <tbody>
        <tr><td class='docs'><p><code>bootstrap.sh</code> - install and configure Linux from scratch or backup onto a
local hard disk, such as <code>/dev/sda</code>, <code>/dev/sdb</code> and <code>/dev/vda</code>. The
default is set as <code>/dev/sda</code>, and you can change it on your <code>$TOP_DIR/localrc</code>
file if you need.</p>

</td><td class=code><div class=highlight><pre>
<span class="c">#!/usr/bin/env bash</span>

</pre></div></td></tr><tr><td class=docs>

<p>Keep track of the top directory.</p>

</td><td class=code><div class=highlight><pre>
<span class="nv">TOP_DIR</span><span class="o">=</span><span class="k">$(</span><span class="nb">cd</span> <span class="k">$(</span>dirname <span class="s2">&quot;$0&quot;</span><span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="nb">pwd</span><span class="k">)</span>

</pre></div></td></tr><tr><td class=docs>

<p>Load local configuration.</p>

</td><td class=code><div class=highlight><pre>
<span class="nb">source</span> <span class="nv">$TOP_DIR</span>/localrc

</pre></div></td></tr><tr><td class=docs>

<p>Load bootstrap configuration.</p>

</td><td class=code><div class=highlight><pre>
<span class="nb">source</span> <span class="nv">$TOP_DIR</span>/bootstraprc

</pre></div></td></tr><tr><td class=docs>

<p>Import common functions.</p>

</td><td class=code><div class=highlight><pre>
<span class="nb">source</span> <span class="nv">$TOP_DIR</span>/functions

</pre></div></td></tr><tr><td class=docs>

<p>Prepare log file.</p>

</td><td class=code><div class=highlight><pre>
<span class="k">if</span> <span class="o">[[</span> -n <span class="s2">&quot;$LOGFILE&quot;</span> <span class="o">]]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nv">LOGDIR</span><span class="o">=</span><span class="k">$(</span>dirname <span class="s2">&quot;$LOGFILE&quot;</span><span class="k">)</span>
    <span class="nv">LOGNAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="s2">&quot;$LOGFILE&quot;</span><span class="k">)</span>
    mkdir -p <span class="nv">$LOGDIR</span>
    <span class="c">#if [[ -f &quot;$LOGFILE&quot; ]]; then</span>
         <span class="c">#mv $LOGFILE ${LOGFILE}.$(date +%Y%m%d-%H%M)</span>
    <span class="c">#fi</span>
    <span class="nb">exec</span> &gt; &gt;<span class="o">(</span>tee -a <span class="s2">&quot;${LOGFILE}&quot;</span><span class="o">)</span> 2&gt;&amp;1
<span class="k">fi</span>

</pre></div></td></tr><tr><td class=docs>

<p>Start the installation.</p>

</td><td class=code><div class=highlight><pre>
<span class="nb">echo</span> <span class="k">$(</span>date<span class="k">)</span>:  <span class="s2">&quot;Starting bootstrap.sh.&quot;</span>

</pre></div></td></tr><tr><td class=docs>

<p>Partition the disk.</p>

</td><td class=code><div class=highlight><pre>
Partitioning

</pre></div></td></tr><tr><td class=docs>

<p>Make file system on the partitions (including swap.)</p>

</td><td class=code><div class=highlight><pre>
MakeFilesystem

</pre></div></td></tr><tr><td class=docs>

<p>Mount partitions.</p>

</td><td class=code><div class=highlight><pre>
MountPertition

</pre></div></td></tr><tr><td class=docs>

<p>Copy OS image.</p>

</td><td class=code><div class=highlight><pre>
CopyOSImage

</pre></div></td></tr><tr><td class=docs>

<p>Get Distro and version info.</p>

</td><td class=code><div class=highlight><pre>
GetDistro

</pre></div></td></tr><tr><td class=docs>

<p>Update differencials.</p>

</td><td class=code><div class=highlight><pre>
UpdateDiff

</pre></div></td></tr><tr><td class=docs>

<p>Install Grub.</p>

</td><td class=code><div class=highlight><pre>
InstallGrub




</pre></div></td></tr><tr><td class=docs>

</td><td class=code><div class=highlight><pre>

</pre></div></td></tr><tr><td class=docs></td><td class='code'></td></tr>
    </tbody>
    </table>
</div>
</body>
</html>
